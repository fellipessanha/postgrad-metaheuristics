name: test
on:
  push:
    branches: [main]
  pull_request:
    types: [opened, synchronize, reopened]
jobs:
  formatter:
    name: Run CI
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ./Exercises
    steps:
      - uses: julia-actions/setup-julia@latest
        with:
          version: '1'
      - uses: actions/checkout@v4
      # - name: Format check
      #   shell: julia --color=yes {0}
      #   run: |
      #     using Pkg
      #     # If you update the version, also update the style guide docs.
      #     Pkg.add(PackageSpec(name="JuliaFormatter", version="1"))
      #     using JuliaFormatter
      #     # print used options for debugging
      #     JuliaFormatter.Options() |> dump |> println
      #     needs_formatting = format(".", verbose=true)
      #     if needs_formatting == 0
      #         exit(0)
      #     end
      #     @error "Some files have not been formatted !!!"
      #     out = `git diff` |> Cmd |> read |> String
      #     write(stdout, out)
      #     exit(1)
      - name: Test check
        shell: julia --proj --color=yes {0}
        run: |
          using Pkg
          Pkg.add("Test")
          Pkg.test(;coverage=true)

